/*
 * Copyright (c) 2012 Brandon Jones
 *
 * This software is provided 'as-is', without any express or implied
 * warranty. In no event will the authors be held liable for any damages
 * arising from the use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 *    1. The origin of this software must not be misrepresented; you must not
 *    claim that you wrote the original software. If you use this software
 *    in a product, an acknowledgment in the product documentation would be
 *    appreciated but is not required.
 *
 *    2. Altered source versions must be plainly marked as such, and must not
 *    be misrepresented as being the original software.
 *
 *    3. This notice may not be removed or altered from any source
 *    distribution.
 */

(function(a){var b;define([],function(){return function(){(function(a){function e(a){var b=document.createEvent("CustomEvent");b.initCustomEvent("fullscreenchange",!0,!1,null),document.dispatchEvent(b)}function f(a){var b=document.createEvent("CustomEvent");b.initCustomEvent("fullscreenerror",!0,!1,null),document.dispatchEvent(b)}function h(a){var b=document.createEvent("CustomEvent");b.initCustomEvent("pointerlockchange",!0,!1,null),document.dispatchEvent(b)}function i(a){var b=document.createEvent("CustomEvent");b.initCustomEvent("pointerlockerror",!0,!1,null),document.dispatchEvent(b)}var b=(a.HTMLElement||a.Element).prototype,c,d=a.GameShim={supports:{fullscreen:!0,pointerLock:!0,gamepad:!0,highResTimer:!0}};(function(){var a=0,b=["webkit","moz","ms","o"],d;for(d=0;d<b.length&&!window.requestAnimationFrame;++d)window.requestAnimationFrame=window[b[d]+"RequestAnimationFrame"];window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame;for(d=0;d<b.length&&!window.cancelAnimationFrame;++d)window.cancelAnimationFrame=window[b[d]+"CancelAnimationFrame"]||window[b[d]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=Date.now(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),window.animationStartTime||(c=function(){for(d=0;d<b.length;++d)if(window[b[d]+"AnimationStartTime"])return function(){return window[b[d]+"AnimationStartTime"]};return function(){return Date.now()}}(),Object.defineProperty(window,"animationStartTime",{enumerable:!0,configurable:!1,writeable:!1,get:c}))})(),document.hasOwnProperty("fullscreenEnabled")||(c=function(){return"webkitIsFullScreen"in document?function(){return webkitRequestFullScreen in document}:"mozFullScreenEnabled"in document?function(){return document.mozFullScreenEnabled}:(d.supports.fullscreen=!1,function(){return!1})}(),Object.defineProperty(document,"fullscreenEnabled",{enumerable:!0,configurable:!1,writeable:!1,get:c})),document.hasOwnProperty("fullscreenElement")||(c=function(){var a=0,b=["webkitCurrentFullScreenElement","webkitFullscreenElement","mozFullScreenElement"];for(;a<b.length;a++)if(b[a]in document)return function(){return document[b[a]]};return function(){return null}}(),Object.defineProperty(document,"fullscreenElement",{enumerable:!0,configurable:!1,writeable:!1,get:c})),document.addEventListener("webkitfullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1),document.addEventListener("webkitfullscreenerror",f,!1),document.addEventListener("mozfullscreenerror",f,!1),b.requestFullscreen||(b.requestFullscreen=function(){return b.webkitRequestFullScreen?function(){this.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:b.mozRequestFullScreen?function(){this.mozRequestFullScreen()}:function(){}}()),document.exitFullscreen||(document.exitFullscreen=function(){return document.webkitExitFullscreen||document.mozCancelFullScreen||function(){}}());var g=a.MouseEvent.prototype;"movementX"in g||Object.defineProperty(g,"movementX",{enumerable:!0,configurable:!1,writeable:!1,get:function(){return this.webkitMovementX||this.mozMovementX||0}}),"movementY"in g||Object.defineProperty(g,"movementY",{enumerable:!0,configurable:!1,writeable:!1,get:function(){return this.webkitMovementY||this.mozMovementY||0}}),navigator.pointer||(navigator.pointer=navigator.webkitPointer||navigator.mozPointer),document.addEventListener("webkitpointerlockchange",h,!1),document.addEventListener("webkitpointerlocklost",h,!1),document.addEventListener("mozpointerlockchange",h,!1),document.addEventListener("mozpointerlocklost",h,!1),document.addEventListener("webkitpointerlockerror",i,!1),document.addEventListener("mozpointerlockerror",i,!1),document.hasOwnProperty("pointerLockElement")||(c=function(){return"webkitPointerLockElement"in document?function(){return document.webkitPointerLockElement}:"mozPointerLockElement"in document?function(){return document.mozPointerLockElement}:function(){return null}}(),Object.defineProperty(document,"pointerLockElement",{enumerable:!0,configurable:!1,writeable:!1,get:c})),b.requestPointerLock||(b.requestPointerLock=function(){return b.webkitRequestPointerLock?function(){this.webkitRequestPointerLock()}:b.mozRequestPointerLock?function(){this.mozRequestPointerLock()}:navigator.pointer?function(){var a=this;navigator.pointer.lock(a,h,i)}:(d.supports.pointerLock=!1,function(){})}()),document.exitPointerLock||(document.exitPointerLock=function(){return document.webkitExitPointerLock||document.mozExitPointerLock||function(){if(navigator.pointer){var a=this;navigator.pointer.unlock()}}}()),navigator.gamepads||(c=function(){if("webkitGamepads"in navigator)return function(){return navigator.webkitGamepads};if("mozGamepads"in navigator)return function(){return navigator.mozGamepads};d.supports.gamepad=!1;var a=[];return function(){return a}}(),Object.defineProperty(navigator,"gamepads",{enumerable:!0,configurable:!1,writeable:!1,get:c})),window.performance||(window.performance={}),window.performance.timing||(window.performance.timing={navigationStart:Date.now()}),window.performance.now||(window.performance.now=function(){return window.performance.webkitNow?window.performance.webkitNow:(d.supports.highResTimer=!1,function(){return Date.now()-window.performance.timing.navigationStart})}())})(typeof exports!="undefined"?global:window)}.call(a),b})})(this)