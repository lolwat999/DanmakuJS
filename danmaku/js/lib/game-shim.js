/*
 * Copyright (c) 2012 Brandon Jones
 *
 * This software is provided 'as-is', without any express or implied
 * warranty. In no event will the authors be held liable for any damages
 * arising from the use of this software.
 *
 * Permission is granted to anyone to use this software for any purpose,
 * including commercial applications, and to alter it and redistribute it
 * freely, subject to the following restrictions:
 *
 *    1. The origin of this software must not be misrepresented; you must not
 *    claim that you wrote the original software. If you use this software
 *    in a product, an acknowledgment in the product documentation would be
 *    appreciated but is not required.
 *
 *    2. Altered source versions must be plainly marked as such, and must not
 *    be misrepresented as being the original software.
 *
 *    3. This notice may not be removed or altered from any source
 *    distribution.
 */

(function(a){var b;define([],function(){return function(){(function(a){function b(a){var b=document.createEvent("CustomEvent");b.initCustomEvent("fullscreenchange",!0,!1,null),document.dispatchEvent(b)}function c(a){var b=document.createEvent("CustomEvent");b.initCustomEvent("fullscreenerror",!0,!1,null),document.dispatchEvent(b)}function d(a){var b=document.createEvent("CustomEvent");b.initCustomEvent("pointerlockchange",!0,!1,null),document.dispatchEvent(b)}function e(a){var b=document.createEvent("CustomEvent");b.initCustomEvent("pointerlockerror",!0,!1,null),document.dispatchEvent(b)}var f=(a.HTMLElement||a.Element).prototype,g,h=a.GameShim={supports:{fullscreen:!0,pointerLock:!0,gamepad:!0,highResTimer:!0}};(function(){var a=0,b=["webkit","moz","ms","o"],c;for(c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"];window.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame;for(c=0;c<b.length&&!window.cancelAnimationFrame;++c)window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=Date.now(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),window.animationStartTime||(g=function(){for(c=0;c<b.length;++c)if(window[b[c]+"AnimationStartTime"])return function(){return window[b[c]+"AnimationStartTime"]};return function(){return Date.now()}}(),Object.defineProperty(window,"animationStartTime",{enumerable:!0,configurable:!1,writeable:!1,get:g}))})(),document.hasOwnProperty("fullscreenEnabled")||(g=function(){return"webkitIsFullScreen"in document?function(){return webkitRequestFullScreen in document}:"mozFullScreenEnabled"in document?function(){return document.mozFullScreenEnabled}:(h.supports.fullscreen=!1,function(){return!1})}(),Object.defineProperty(document,"fullscreenEnabled",{enumerable:!0,configurable:!1,writeable:!1,get:g})),document.hasOwnProperty("fullscreenElement")||(g=function(){var a=0,b=["webkitCurrentFullScreenElement","webkitFullscreenElement","mozFullScreenElement"];for(;a<b.length;a++)if(b[a]in document)return function(){return document[b[a]]};return function(){return null}}(),Object.defineProperty(document,"fullscreenElement",{enumerable:!0,configurable:!1,writeable:!1,get:g})),document.addEventListener("webkitfullscreenchange",b,!1),document.addEventListener("mozfullscreenchange",b,!1),document.addEventListener("webkitfullscreenerror",c,!1),document.addEventListener("mozfullscreenerror",c,!1),f.requestFullscreen||(f.requestFullscreen=function(){return f.webkitRequestFullScreen?function(){this.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}:f.mozRequestFullScreen?function(){this.mozRequestFullScreen()}:function(){}}()),document.exitFullscreen||(document.exitFullscreen=function(){return document.webkitExitFullscreen||document.mozCancelFullScreen||function(){}}());var i=a.MouseEvent.prototype;"movementX"in i||Object.defineProperty(i,"movementX",{enumerable:!0,configurable:!1,writeable:!1,get:function(){return this.webkitMovementX||this.mozMovementX||0}}),"movementY"in i||Object.defineProperty(i,"movementY",{enumerable:!0,configurable:!1,writeable:!1,get:function(){return this.webkitMovementY||this.mozMovementY||0}}),navigator.pointer||(navigator.pointer=navigator.webkitPointer||navigator.mozPointer),document.addEventListener("webkitpointerlockchange",d,!1),document.addEventListener("webkitpointerlocklost",d,!1),document.addEventListener("mozpointerlockchange",d,!1),document.addEventListener("mozpointerlocklost",d,!1),document.addEventListener("webkitpointerlockerror",e,!1),document.addEventListener("mozpointerlockerror",e,!1),document.hasOwnProperty("pointerLockElement")||(g=function(){return"webkitPointerLockElement"in document?function(){return document.webkitPointerLockElement}:"mozPointerLockElement"in document?function(){return document.mozPointerLockElement}:function(){return null}}(),Object.defineProperty(document,"pointerLockElement",{enumerable:!0,configurable:!1,writeable:!1,get:g})),f.requestPointerLock||(f.requestPointerLock=function(){return f.webkitRequestPointerLock?function(){this.webkitRequestPointerLock()}:f.mozRequestPointerLock?function(){this.mozRequestPointerLock()}:navigator.pointer?function(){var a=this;navigator.pointer.lock(a,d,e)}:(h.supports.pointerLock=!1,function(){})}()),document.exitPointerLock||(document.exitPointerLock=function(){return document.webkitExitPointerLock||document.mozExitPointerLock||function(){if(navigator.pointer){var a=this;navigator.pointer.unlock()}}}()),navigator.gamepads||(g=function(){if("webkitGamepads"in navigator)return function(){return navigator.webkitGamepads};if("mozGamepads"in navigator)return function(){return navigator.mozGamepads};h.supports.gamepad=!1;var a=[];return function(){return a}}(),Object.defineProperty(navigator,"gamepads",{enumerable:!0,configurable:!1,writeable:!1,get:g})),window.performance||(window.performance={}),window.performance.timing||(window.performance.timing={navigationStart:Date.now()}),window.performance.now||(window.performance.now=function(){return window.performance.webkitNow?window.performance.webkitNow:(h.supports.highResTimer=!1,function(){return Date.now()-window.performance.timing.navigationStart})}())})(typeof exports!="undefined"?global:window)}.call(a),b})})(this)