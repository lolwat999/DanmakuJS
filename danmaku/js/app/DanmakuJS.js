define(["require","lib/game-shim","lib/inheritance","lib/jquery-1.8b1","lib/Stats","lib/Three","GameSceneTest","GameStateManager"],function(a){a("lib/game-shim"),a("lib/inheritance"),a("lib/jquery-1.8b1");var b=a("lib/Stats"),c=a("lib/Three"),d=a("GameSceneTest"),e=a("GameStateManager"),f=function(a){a=a||{};var f=this;this.container=$(a.container||document.body),this.stats=new b,this.timer=new c.Clock,this.scaleX=1,this.scaleY=1,this.gameStateManager=new e,this.start=function(){var a=f.container.width(),b=f.container.height();f.container.html(" "),f.renderer=new c.WebGLRenderer,f.renderer.setSize(a,b),$(f.stats.domElement).addClass("overlay"),f.container.append(f.stats.domElement),f.container.append(f.renderer.domElement),f.gameStateManager.add(new d(f)),window.addEventListener("resize",this.onResized,!1),f.mainLoop()},this.mainLoop=function(){f.stats.begin(),f.gameStateManager.current().updateAll(f.timer.getDelta()),f.gameStateManager.current().renderAll(f.renderer),f.stats.end(),requestAnimationFrame(f.mainLoop)},this.setSize=function(a,b){f.scaleX=a,f.scaleY=b,f.onResized()},this.onResized=function(){var a=f.container.width()*f.scaleX,b=f.container.height()*f.scaleY;f.gameStateManager.states.forEach(function(c){c.onResized(a,b)}),f.renderer.setSize(a,b)}};return f})