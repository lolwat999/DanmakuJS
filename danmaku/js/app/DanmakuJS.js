define(["require","lib/game-shim","lib/inheritance","lib/jquery-1.8b1","lib/Stats","lib/Three","GameSceneTest","GameStateManager"],function(a){a("lib/game-shim"),a("lib/inheritance"),a("lib/jquery-1.8b1");var b=a("lib/Stats"),c=a("lib/Three"),d=a("GameSceneTest"),e=a("GameStateManager"),f=function(){var a=this;this.stats=new b,this.timer=new c.Clock,this.scaleX=1,this.scaleY=1,this.gameStateManager=new e,this.start=function(b){b=b||{},this.container=$(b.container||document.body);var e=a.container.width(),f=a.container.height();a.container.html(" "),a.renderer=new c.WebGLRenderer,a.renderer.setSize(e,f),$(a.stats.domElement).addClass("overlay"),a.container.append(a.stats.domElement),a.container.append(a.renderer.domElement),a.gameStateManager.add(new d(a)),window.addEventListener("resize",this.onResized,!1),a.mainLoop()},this.mainLoop=function(){a.stats.begin(),a.gameStateManager.current().updateAll(a.timer.getDelta()),a.gameStateManager.current().renderAll(a.renderer),a.stats.end(),requestAnimationFrame(a.mainLoop)},this.setSize=function(b,c){a.scaleX=b,a.scaleY=c,a.onResized()},this.onResized=function(){var b=a.container.width()*a.scaleX,c=a.container.height()*a.scaleY;a.gameStateManager.states.forEach(function(a){a.onResized(b,c)}),a.renderer.setSize(b,c)}};return new f})