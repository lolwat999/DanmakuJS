define(["require","./GameScene","./Bullet","./BulletPattern","./Player","./Tasks","./OverlayState","./Entity","./Enemy","./PolarVector"],function(a){var b=a("./GameScene"),c=a("./Bullet"),d=a("./BulletPattern"),e=a("./Player"),f=a("./Tasks"),g=a("./OverlayState"),h=a("./Entity"),i=a("./Enemy"),j=a("./PolarVector"),k=b.extend({init:function(a,b,c){this._super(a,b,c),this.addPlayer(),this.foreground=new g(a),this.foreground.uiFrame=new h({x:0,y:0,image:"frame.png"}),this.foreground.add(this.foreground.uiFrame)},addPlayer:function(){var a=this;this.add(new e({x:a.gameArea.width/2,y:100,image:"characters/marisa.png",scale:2.5,shots:{Shoot:l}}))},addEnemy:function(a){var b=this;b.frame%20||this.add(new i({x:Math.random()*b.gameArea.width,y:b.gameArea.height,xSpeed:-(Math.random()*10)+5,ySpeed:5,scale:2.5,angle:180,image:"characters/marisa.png",tasks:[m]}))},update:function(a){this._super(a),this.addEnemy(a)}}),l=function(a,b,d,e){for(var f=0,g=5;f<g;++f)e.fire(new c({x:b.x,y:b.y,owner:b,angle:15/g*f-7,image:"bullets/circlegreensm.png",life:1e3,speed:15}),d);e.cooldown=15},m=function(a,b,d){if(d.frame%5||b&&b.outOfBounds())return;var e=d.gameArea,f=b?b.x:e.width/2,g=b?b.y:e.height/2,h=this.angle||0,i=new c({x:f,y:g,angle:h,life:500,image:"bullets/arrow.png",scale:.5,owner:b,tasks:[function(a,b,c){b.angle+=.25}]});i.model.color.setHSV(Math.random(),1,1),d.add(i),this.angle=(h+16)%360};return k})