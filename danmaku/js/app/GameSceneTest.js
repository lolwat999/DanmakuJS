define(["require","./GameScene","./Bullet","./Tasks"],function(a){var b=a("./GameScene"),c=a("./Bullet"),d=a("./Tasks"),e=b.extend({init:function(a,b,c){var e=this;this._super(a,b,c),this.angle=0,this.add(new d({tasks:[e.tasks.addCircle]}))},tasks:{addCircle:function(a,b,d){var e=d.getSize();d.entities.forEach(function(a){a instanceof c&&a.angle++});for(var f=0;f<2;++f){var g=this.angle||0;d.add(new c({x:e.width/2,y:e.height/2,angle:g,life:250,image:"bullets/arrow.png",color:Math.floor(Math.random()*16777216)})),this.angle=(g+16)%360}Math.floor(this.time)%1e3===999&&(this.tasks.remove(this),this.tasks.add(d.tasks.addBullet))},addBullet:function(a,b,d){if(Date.now()%8===0){var e=d.getSize();d.add(new c({x:e.width/2,y:e.height/2,angle:Math.random()*360,life:50,speed:3+Math.random()*10,image:"bullets/arrow.png",tasks:[d.tasks.arrowTask]}))}},arrowTask:function(a,b,d){b.angle++;if(b.time>b.life-40&&Math.floor(b.time)%2===0){this.angle=this.angle?this.angle+16:b.angle;var e=this.angle;d.add(new c({x:b.x,y:b.y,angle:e,life:150,image:"bullets/circleredsm.png",color:Math.floor(Math.random()*16777216)}))}}},update:function(a){this._super(a)}});return e})